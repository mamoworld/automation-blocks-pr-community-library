<xml xmlns="https://developers.google.com/blockly/xml"><variables><variable id="kwM8zW(xhmx*pjtZ%vbV">new filename</variable></variables><block type="es_tutorial" id="{9QY8V]n}8clQvs10sSL" x="180" y="130"><field name="WATCH_TUT_LABEL">open web page</field><field name="TITLE">see this forum discussion</field><field name="URL">https://community.adobe.com/t5/premiere-pro-discussions/automation-blocks-increment-version-and-save/m-p/15140485#M551966</field></block><block type="variables_set" id="cia(7vkHGX?dJ[|C35k-" x="180" y="322"><field name="VAR" id="kwM8zW(xhmx*pjtZ%vbV">new filename</field><value name="VALUE"><block type="pr_execute_code" id="_m1^S.41eZKf?UVXUyO1"><mutation items="1" resultType="other"></mutation><field name="FIELD_VAR_NAME_0">fileName</field><field name="FIELD_VAR_TYPE_0">other</field><field name="RESULT_TYPE">other</field><value name="ADD0"><shadow type="text" id="!bd$PR(4VTIBhV5$Uir%"><field name="TEXT">variable value</field></shadow><block type="block_pr_project_file" id="t0sh;]o1kYDZXs)xrpRj"><value name="PROJECT"><shadow type="pr_project_active_project" id="e7;IcLh%%}O_tdDo.2I)"></shadow></value></block></value><value name="CODE"><shadow type="text_multiline" id="WHG@XOuD}rEd}`7hTFK6"><field name="TEXT">function getNextVersionFilename(fileName) {&amp;#10;    var versionRegex = /(.*)_V(\d+)(\.\w+)$/i; // Match "_V&lt;number&gt;" before the extension&amp;#10;    var match = fileName.match(versionRegex);&amp;#10;    &amp;#10;    if (match) {&amp;#10;        var baseName = match[1];&amp;#10;        var version = parseInt(match[2], 10) + 1;&amp;#10;        var extension = match[3];&amp;#10;        return baseName + "_V" + version + extension;&amp;#10;    } else {&amp;#10;        var dotIndex = fileName.lastIndexOf(".");&amp;#10;        if (dotIndex !== -1) {&amp;#10;            var baseName = fileName.substring(0, dotIndex);&amp;#10;            var extension = fileName.substring(dotIndex);&amp;#10;            return baseName + "_V1" + extension;&amp;#10;        } else {&amp;#10;            return fileName + "_V1"; // Handle case with no extension&amp;#10;        }&amp;#10;    }&amp;#10;}&amp;#10;getNextVersionFilename(fileName) </field></shadow></value></block></value><next><block type="pr_project_save_as" id="tAr?/WtMn?t5e=Eo5U|Y"><field name="OVERWRITE">FALSE</field><field name="CREATE_FOLDER">TRUE</field><value name="PROJECT"><shadow type="pr_project_active_project" id="5TQKUVw_hr.Ja+@`sWu+"></shadow></value><value name="FILE"><shadow type="block_extendscript_file" id="Ne=?HZee;*IjFV^`5YPw"><field name="FILE_PATH">~/Desktop/myProject.prproj</field></shadow><block type="variables_get" id="(ClL$+N=YcCnUty2oa#o"><field name="VAR" id="kwM8zW(xhmx*pjtZ%vbV">new filename</field></block></value></block></next></block><block type="mm_multiline_comment_block" id="L5X%k5Dgebl{z+4#dHfZ" x="1064" y="735"><field name="TEXT">ChatGPT wrote this function for me. I used&amp;#10;the following prompt:&amp;#10;&amp;#10;Please write a Adobe ExtendScript function "getNextVersionFilename" which takes as arguments "fileName" and returns a new file name for the next version.&amp;#10;If fileName is "myProject_V1.prproj" then it should return "myProject_V2.prproj", for example.&amp;#10;Always increment the version number at the end by one. Or add a new version number 1 if there is no version number, yet.</field></block></xml>